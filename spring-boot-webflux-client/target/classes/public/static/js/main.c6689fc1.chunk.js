(this["webpackJsonpcrud-react-webpage"]=this["webpackJsonpcrud-react-webpage"]||[]).push([[0],{22:function(e,t,i){},23:function(e,t,i){},42:function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),c=i(4),a=i.n(c),s=(i(21),i(22),i(11)),o=(i(23),i(9)),u=i.n(o),d=i(14),l=i(2),h=i(3),v=i(6),g=i(5),f=i(15),m=function(){function e(t){Object(l.a)(this,e),this.value=void 0,this.label=void 0,void 0==t?(this.value="0",this.label=""):(this.value=t.value,this.label=t.label)}return Object(h.a)(e,[{key:"getValue",value:function(){return this.value}},{key:"getLabel",value:function(){return this.label}}]),e}(),p=new m({value:"0",label:""}),b=function(){function e(t){Object(l.a)(this,e),this.id=void 0,this.name=void 0,void 0==t?(this.id="",this.name=""):(this.id=t.id,this.name=t.name)}return Object(h.a)(e,[{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){this.id=e}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}}]),e}(),j=function(){function e(t){Object(l.a)(this,e),this.id=void 0,this.name=void 0,this.price=void 0,this.createdAt=void 0,this.category=void 0,this.picture=void 0,void 0==t?(this.id="",this.name="",this.price=0,this.createdAt=new Date,this.category=new b(void 0),this.picture=""):(this.id=t.id,this.name=t.name,this.price=t.price,this.createdAt=t.createdAt,this.category=new b(t.category),this.picture=t.picture)}return Object(h.a)(e,[{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){this.id=e}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getPrice",value:function(){return this.price}},{key:"setPrice",value:function(e){this.price=e}},{key:"getCreatedAt",value:function(){return this.createdAt}},{key:"setCreatedAt",value:function(e){this.createdAt=e}},{key:"getCategory",value:function(){return this.category}},{key:"setCategory",value:function(e){this.category=e}},{key:"getPicture",value:function(){return this.picture}},{key:"setPicture",value:function(e){this.picture=e}}]),e}();function y(e){return JSON.parse(JSON.stringify(e))}var O=function(){function e(){Object(l.a)(this,e)}return Object(h.a)(e,null,[{key:"dateToString",value:function(e){return void 0==e?"":function(e){return e instanceof Date?e.getDay().toString()+"-"+e.getMonth().toString()+"-"+e.getFullYear().toString():""}(e)}},{key:"dateToStringP",value:function(e){return new Promise((function(t,i){t(e.toString())}))}}]),e}();var P=i(1),N=function(e){Object(v.a)(i,e);var t=Object(g.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).categories=void 0,n.productService=void 0,n.product=void 0,n.productService=e.productService,n.categories=[],n.product=new j(void 0),n.state={loading:!0,editing:!1,categoriesOptions:[],inputName:"",inputPrice:0,categoryOptionSelected:p,formValid:!1},n}return Object(h.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.productService.serverGetCategories().then((function(t){e.categories=t;var i=[];t.forEach((function(e){var t=new m({value:e.getId(),label:e.getName()});i.push(t)}));var n=y(e.state);n.categoriesOptions=i,n.loading=!1,e.resetForm(e),e.setState(n)})),this.productService.getProductToEdit().subscribe((function(t){return e.onEditProduct(t,e)}))}},{key:"onEditProduct",value:function(e,t){var i=y(t.state),n=t.product;t.resetForm(t),n.setId(e.getId()),n.setName(e.getName()),n.setCreatedAt(e.getCreatedAt()),n.setPrice(e.getPrice()),n.setCategory(e.getCategory()),n.setPicture(e.getPicture()),i.inputPrice=e.getPrice(),i.inputName=e.getName(),i.categoryOptionSelected=t.getOptionByValue(e.getCategory().getId(),t),i.formValid=!0,i.editing=!0,i.loading=!1,this.setState(i)}},{key:"resetForm",value:function(e){var t=y(e.state),i=e.product;i.setId(""),i.setName(""),i.setCreatedAt(new Date),i.setPrice(0),i.setPicture(""),i.setCategory(e.categories[0]),t.inputPrice=0,t.inputName="",t.categoryOptionSelected=p,t.formValid=!1,t.editing=!1,t.loading=!1,e.setState(t)}},{key:"getCategoryById",value:function(e){var t=this.categories.find((function(t){return t.getId()==e}));return void 0!=t?t:new b(void 0)}},{key:"getOptionByValue",value:function(e,t){var i=t.state.categoriesOptions.find((function(t){return t.value==e}));return void 0!=i?i:p}},{key:"onSelected",value:function(e,t,i){var n=new m(e),r=i.getCategoryById(n.getValue()),c=y(i.state),a=i.product;void 0!=r&&a.setCategory(r),c.categoryOptionSelected=e,i.setState(c)}},{key:"onChangeField",value:function(e,t){var i=y(t.state),n=e.target.name,r=t.product,c=e.target.value;switch(n){case"nameName":i.inputName=c,r.setName(c);break;case"namePrice":var a=c.length>0?parseFloat(c):0;i.inputPrice=a,r.setPrice(a)}i.formValid=i.inputName.length>0&&i.inputPrice>0,t.setState(i)}},{key:"submit",value:function(){var e=Object(d.a)(u.a.mark((function e(t,i){var n,r,c,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),y(i.state),n=new j(y(i.product)),r=i.state.inputPrice,c=i.state.inputName,a=new m(i.state.categoryOptionSelected),s=i.getCategoryById(a.getValue()),n.setName(c),n.setPrice(r),n.setCategory(s),!i.state.editing){e.next=16;break}return e.next=13,i.productService.serverUpdateProduct(n);case 13:e.sent,e.next=19;break;case 16:return e.next=18,i.productService.serverAddProduct(n);case 18:e.sent;case 19:return i.resetForm(i),e.t0=i.productService,e.next=23,i.productService.serverGetProducts();case 23:e.t1=e.sent,e.t0.setNewList.call(e.t0,e.t1);case 25:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(P.jsx)("div",{className:"card",children:Object(P.jsxs)("div",{className:"card-body",children:[Object(P.jsxs)("h5",{className:"title mb-3",children:[Object(P.jsx)("span",{children:"Product Editor"}),this.state.loading&&Object(P.jsx)("div",{className:"spinner-border float-end",role:"status",children:Object(P.jsx)("span",{className:"visually-hidden",children:"loading..."})})]}),Object(P.jsxs)("form",{onSubmit:function(t){return e.submit(t,e)},children:[Object(P.jsxs)("div",{className:"form-group",children:[Object(P.jsx)("label",{htmlFor:"nameName",children:"Name"}),Object(P.jsx)("input",{type:"text",value:this.state.inputName,className:"form-control",id:"idName","data-testid":"idName",onChange:function(t){return e.onChangeField(t,e)},name:"nameName",required:!0})]}),Object(P.jsxs)("div",{className:"form-group",children:[Object(P.jsx)("label",{htmlFor:"namePrice",children:"Price"}),Object(P.jsx)("input",{type:"number",value:this.state.inputPrice,className:"form-control",id:"idPrice","data-testid":"idPrice",onChange:function(t){return e.onChangeField(t,e)},name:"namePrice",max:"200000",min:"0",step:"0.001"})]}),Object(P.jsxs)("div",{className:"form-group",children:[Object(P.jsx)("label",{htmlFor:"nameCategorySelector",children:"Category"}),Object(P.jsx)(f.a,{options:this.state.categoriesOptions,value:this.state.categoryOptionSelected,className:"form-control",id:"idCategorySelector",name:"nameCategorySelector","data-testid":"idCategorySelector",onChange:function(t,i){return e.onSelected(t,i,e)}})]}),Object(P.jsx)("div",{className:"d-grid gap-2",children:Object(P.jsxs)("button",{className:"btn btn-success btn-lg",type:"submit","data-testid":"idSubmitButton",id:"idSubmitButton",disabled:!this.state.formValid,children:[Object(P.jsx)("i",{className:"fas fa-database"}),this.state.editing?"savechanges":"add"]})})]})]})})}}]),i}(n.Component),x=i(10),k=function(e){Object(v.a)(i,e);var t=Object(g.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).productService=void 0,n.productService=e.productService,n.state={productList:[]},n}return Object(h.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.getProductList(this),this.productService.getNewList().subscribe((function(t){return e.updateProductList(t,e)}))}},{key:"getProductList",value:function(e){this.productService.serverGetProducts().then((function(t){return e.updateProductList(t,e)}))}},{key:"updateProductList",value:function(e,t){t.setState({productList:e})}},{key:"clickEditCreditCard",value:function(e,t){t.productService.addProductToEdit(e)}},{key:"clickDeleteCreditCard",value:function(e,t){t.productService.serverDeleteProduct(e.getId()).then((function(e){e&&t.getProductList(t)})).catch((function(e){console.error(e.message)}))}},{key:"render",value:function(){var e=this;return Object(P.jsx)("div",{className:"card",children:Object(P.jsxs)("div",{className:"card-body",children:[Object(P.jsx)("h5",{className:"title",children:"Product List"}),Object(P.jsx)("table",{className:"table",children:Object(P.jsx)("tbody",{"data-testid":"idTableProducts",children:this.state.productList.map((function(t,i){return Object(P.jsxs)("tr",{children:[Object(P.jsx)("td",{children:(n=t.getId(),n.substr(n.length-4,4))}),Object(P.jsx)("td",{children:t.getName()}),Object(P.jsx)("td",{children:t.getPrice().toString()}),Object(P.jsx)("td",{children:O.dateToString(t.getCreatedAt())}),Object(P.jsx)("td",{children:t.getCategory().getName()}),Object(P.jsx)("td",{children:t.getPicture()}),Object(P.jsxs)("td",{children:[Object(P.jsx)(x.a,{className:"text-info","data-testid":"edit"+i,onClick:function(){e.clickEditCreditCard(t,e)}}),Object(P.jsx)(x.b,{className:"text-danger","data-testid":"delete"+i,onClick:function(){e.clickDeleteCreditCard(t,e)}})]})]},"key"+i);var n}))})})]})})}}]),i}(n.Component),S=i(43),C="/api/client",w=function(){function e(){Object(l.a)(this,e),this.productToEdit$=new S.a,this.productList$=new S.a}return Object(h.a)(e,[{key:"serverGetCategories",value:function(){return new Promise((function(e,t){fetch("/api/client/categories").then((function(e){return e.json()})).then((function(i){try{var n=[];i.forEach((function(e){var t=new b(e);n.push(t)})),e(n)}catch(r){t(r)}})).catch((function(e){console.error(e.message),t(e)}))}))}},{key:"serverAddProduct",value:function(e){return void 0==e?Promise.reject("product to save cannot be empty"):fetch(C,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}},{key:"serverGetProducts",value:function(){return new Promise((function(e,t){fetch(C).then((function(e){return e.json()})).then((function(i){try{var n=[];i.forEach((function(e){var t=new j(e);n.push(t)})),e(n)}catch(r){t(r)}})).catch((function(e){console.error(e.message),t(e)}))}))}},{key:"serverDeleteProduct",value:function(e){return void 0==e?Promise.reject("id of product to delete cannot be empty"):new Promise((function(t,i){fetch("/api/client/"+e,{method:"DELETE"}).then((function(e){t(e.ok)})).catch((function(e){i(e)}))}))}},{key:"serverUpdateProduct",value:function(e){return void 0==e?Promise.reject("product to update cannot be empty"):fetch("/api/client/"+e.getId(),{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}},{key:"addProductToEdit",value:function(e){this.productToEdit$.next(e)}},{key:"getProductToEdit",value:function(){return this.productToEdit$.asObservable()}},{key:"setNewList",value:function(e){this.productList$.next(e)}},{key:"getNewList",value:function(){return this.productList$.asObservable()}}]),e}();var L=function(){var e={productService:new w};return Object(P.jsxs)("div",{className:"container mt-5",children:[Object(P.jsx)("div",{className:"row",children:Object(P.jsx)("div",{className:"col-lg-8 offset-lg-2",children:Object(P.jsx)("div",{className:"card",children:Object(P.jsx)("div",{className:"card-body",children:Object(P.jsx)("h1",{className:"title",children:"Products in Dollars App"})})})})}),Object(P.jsxs)("div",{className:"row mt-4",children:[Object(P.jsx)("div",{className:"col-lg-6",children:Object(P.jsx)(N,Object(s.a)({},e))}),Object(P.jsx)("div",{className:"col-lg-6",children:Object(P.jsx)(k,Object(s.a)({},e))})]})]})},E=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,44)).then((function(t){var i=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,a=t.getTTFB;i(e),n(e),r(e),c(e),a(e)}))};a.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(L,{})}),document.getElementById("root")),E()}},[[42,1,2]]]);
//# sourceMappingURL=main.c6689fc1.chunk.js.map